<html>
    <head>
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
        <script>
	   function validateNumber(){
			let number_value = document.getElementById("number").value;
			if(number_value == "" || number_value == " "){
				document.getElementById("error").value="Please enter number";
				document.getElementById("error").style.color="red";
				return false;
			}
			
			let mdn = number_value = "+91"+ number_value;
			const apikey="kFrA3jdkEPvHafFum92krrepDJWIVNoeRgag4pJ3";
			var endpoint = "https://api.numlookupapi.com/v1/validate/" + mdn + "?apikey=key";

			var xhr = new XMLHttpRequest();
			xhr.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					var response = JSON.parse(this.responseText);
					//if(response.status !== 'success') {
					if(response !== '') {
						//console.log('query failed: ' + response.message);
						document.getElementById("status").value= response.valid;
						document.getElementById("operator").value= response.carrier;
						document.getElementById("location").value= response.location;
						document.getElementById("country_name").value= response.country_name;
						//return
					}
					document.getElementById("error").innerHtml="issue";
					console.log(response.valid);
					console.log(response.carrier);
					console.log(response.location);
					console.log(response.country_name);
					console.log('query success: ' + response);
					return true;
					/*
					// Redirect
					if(response.countryCode == "US") {
						window.location.replace("https://google.com/");
					}
					if(response.countryCode == "CA") {
						window.location.replace("https://google.ca/");
					}*/
				}
			};
			xhr.open('GET', endpoint, true);
			xhr.send();

	   }
        </script>
    </head>
    <body>
        <form action="#" method="get" onsubmit="return false">
            <h3>Enter number to check status</h3><br>
            <span id="error"></span><br><br>
            <label>Mobile Number:</label>
            <input type="text" name="number" id="number" /><br><br>
			 status: <span id="status"></span><br>
			 operator: <span id="operator"></span><br>
			 location: <span id="location"></span><br>
			 country_name: <span id="country_name"></span><br><br>
            <input type="submit" value="Request to check" id="submit" onclick="validateNumber();"/>
        </form>
    </body>
</html>